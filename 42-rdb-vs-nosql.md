# RDB v.s. NoSQL

RDB: Relational Database, 即關連式資料庫

NoSQL: Not Only SQL, 即"非關連式資料庫"的統稱

#### RDB的優點:

* Transaction處理: 保持資料的一致性
* 以標準化為前提, 資料更新的開銷比較小\(相同的欄位基本上只有一處\)
* 可進行join等複雜的查詢

#### RDB的缺點:

* 擴展不易: 因為存在join這種多表查詢的機制, 使得資料庫在擴展方面比較艱難
* 讀寫速度的瓶頸: 這種情況主要發生在數據量達到一定規模時由於關聯式資料庫的系統邏輯較為複雜, 使得其非常容易發生死鎖等的concurrency問題，進而導致其讀寫速度下滑非常嚴重
* 成本高: 看看那精美的Oracle Enterprise Lisence費用, 而且成本會隨著系統規模成長而不斷上升
* 有限的支撐容量: 現有個關聯式解決方案對於海量資料其實不太能夠支撐得住

#### NoSQL的優點:

* 擴展簡單方便, 特別是水平橫向的擴展: 如Cassandra, MongoDB

  * 縱向擴展: 買更強的機器
  * 橫向擴展: 把資料分散到多台機器

* 讀寫快速高效, 多數都會映射到記憶體操作: 如Redis

* 成本低廉, 用普通機器, 分布式集群即可

* 資料模型靈活, 沒有固定的資料模型: 當今出現越來越多非結構化資料的需求

#### NoSQL缺點:

* 不提供對SQL的支持: 這基本上會對使用者產生一定的學習和應用遷移成本
* 支持的特性不夠豐富: 大多數NoSQL都不支持transaction, 也可能沒有BI或報表這類東西
* 現有產品不夠成熟穩定

透過以上比較, 其實不難發現NoSQL在架構和資料模型方面做了"減法"; 而在擴展性與並發性上做了"加法".

可以考慮使用NoSQL的情況:

* DB schema經常發生變化: 常見例子如線上商城, 維護產品的屬性經常要增加新欄位/減少欄位, 這就表示說你的ORM/DAO層的程式和config會需要做更動, 若該table的資料量超過百萬級別, 新增欄位帶來的開銷其實是很可怕的\(想想index重建這種事情\). 這種時候就可以考慮以NoSQL作為解決方案, 以提升DB的可伸縮性.
* DB table的欄位是複雜資料類型: 對於複雜的資料類型來說, 很多NoSQL會以json-like的方式來儲存\(如MongoDB\), 且提供了原生的支持, 在效率上是比RDB高的.
* 高並發的資料庫請求: 在一些web2.0的應用中, 由於對資料一致性的要求比較低, 這時候RDB的transaction以及join等特性反而就會在性能方面扯後腿了, 當然這道理不見得所有場景都適用, 這邊有篇[文章](http://artur.ejsmont.org/blog/content/insert-performance-comparison-of-nosql-vs-sql-servers)做了些比較, 挺有趣的, 可以參考看看.
* 海量資料的分布式儲存: 不是每間公司都付得起Oracle要的錢, 所以利用NoSQL分布式儲存並且部署到廉價的硬體上, 是一種CP值相對高的解決方案, 像MongoDB的sharding已經可以應用到productiong上了\(~~雖然還是被炮轟的滿慘的~~\).



